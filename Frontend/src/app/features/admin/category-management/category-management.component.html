<div class="category-admin max-w-7xl mx-auto px-4 py-6 space-y-6">
  <app-admin-nav activeTab="categories" [pendingMentorCount]="pendingMentorCount"></app-admin-nav>

  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-semibold">Category Management</h1>
      <p class="text-sm text-gray-500">Manage mentor categories.</p>
    </div>
    <button class="btn btn-primary" type="button" (click)="openCreateModal()">+ Add Category</button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="space-y-3">
    <div class="h-16 bg-gray-200 rounded animate-pulse"></div>
    <div class="h-16 bg-gray-100 rounded animate-pulse"></div>
  </div>

  <!-- Table -->
  <div class="card p-4" *ngIf="!loading">
    <table class="table" *ngIf="categories.length > 0">
      <thead>
        <tr>
          <th>Icon</th>
          <th>Name</th>
          <th>Description</th>
          <th>Mentors</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cat of categories" [class.opacity-50]="!cat.isActive">
          <td class="text-2xl">{{ cat.iconUrl || 'üìÅ' }}</td>
          <td class="font-medium">{{ cat.name }}</td>
          <td class="text-sm text-gray-500 max-w-xs truncate">{{ cat.description || '‚Äî' }}</td>
          <td>{{ cat.mentorCount || 0 }}</td>
          <td>
            <span class="badge" [class.badge-success]="cat.isActive" [class.badge-gray]="!cat.isActive">
              {{ cat.isActive ? 'Active' : 'Inactive' }}
            </span>
          </td>
          <td class="flex gap-2">
            <button class="btn btn-secondary btn-sm" type="button" (click)="openEditModal(cat)">Edit</button>
            <button class="btn btn-sm" [class.btn-warning]="cat.isActive" [class.btn-success]="!cat.isActive" type="button" (click)="toggleActive(cat)" [disabled]="togglingId === cat.id">
              {{ cat.isActive ? 'Deactivate' : 'Activate' }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <div *ngIf="categories.length === 0" class="text-center py-8 text-gray-500">No categories found.</div>
  </div>
</div>

<!-- Modal -->
<div *ngIf="showModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl">
    <h3 class="text-lg font-semibold mb-4">{{ editingCategory ? 'Edit Category' : 'Create Category' }}</h3>
    <div class="space-y-4">
      <div>
        <label class="label">Name *</label>
        <input class="input" type="text" [(ngModel)]="form.name" placeholder="Category name" />
      </div>
      <div>
        <label class="label">Description</label>
        <textarea class="input" [(ngModel)]="form.description" placeholder="Optional description" rows="2"></textarea>
      </div>
      <div>
        <label class="label">Icon (emoji)</label>
        <input class="input" type="text" [(ngModel)]="form.iconUrl" placeholder="e.g. üíª" />
      </div>
    </div>
    <div class="flex justify-end gap-2 mt-6">
      <button class="btn btn-secondary" type="button" (click)="closeModal()">Cancel</button>
      <button class="btn btn-primary" type="button" (click)="save()" [disabled]="saving || !form.name.trim()">
        {{ saving ? 'Saving...' : (editingCategory ? 'Update' : 'Create') }}
      </button>
    </div>
  </div>
</div>
